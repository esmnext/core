---
titleSuffix: Абстрактный интерфейс приложения Esmx
description: Подробное описание интерфейса App в рамках Esmx, включая управление жизненным циклом приложения, обработку статических ресурсов и функции серверного рендеринга, чтобы помочь разработчикам понять и использовать ключевые функции приложения.
head:
  - - meta
    - property: keywords
      content: Esmx, App, абстракция приложения, жизненный цикл, статические ресурсы, серверный рендеринг, API
---

# App

`App` — это абстракция приложения в рамках Esmx, предоставляющая унифицированный интерфейс для управления жизненным циклом приложения, обработки статических ресурсов и серверного рендеринга.

```ts title="entry.node.ts"
export default {
  // Конфигурация для среды разработки
  async devApp(esmx) {
    return import('@esmx/rspack').then((m) =>
      m.createRspackHtmlApp(esmx, {
        config(rc) {
          // Пользовательская конфигурация Rspack
        }
      })
    );
  }
}
```

## Определение типов
### App

```ts
interface App {
  middleware: Middleware;
  render: (options?: RenderContextOptions) => Promise<RenderContext>;
  build?: () => Promise<boolean>;
  destroy?: () => Promise<boolean>;
}
```

#### middleware

- **Тип**: `Middleware`

Промежуточное ПО для обработки статических ресурсов.

В среде разработки:
- Обрабатывает запросы статических ресурсов исходного кода
- Поддерживает горячую перезагрузку и компиляцию в реальном времени
- Использует стратегию кэширования no-cache

В производственной среде:
- Обрабатывает статические ресурсы после сборки
- Поддерживает долгосрочное кэширование неизменяемых файлов (.final.xxx)
- Оптимизированная стратегия загрузки ресурсов

```ts
server.use(esmx.middleware);
```

#### render

- **Тип**: `(options?: RenderContextOptions) => Promise<RenderContext>`

Функция серверного рендеринга. Предоставляет различные реализации в зависимости от среды выполнения:
- Производственная среда (start): Загружает и выполняет рендеринг с использованием серверного входного файла после сборки (entry.server)
- Среда разработки (dev): Загружает и выполняет рендеринг с использованием серверного входного файла из исходного кода

```ts
const rc = await esmx.render({
  params: { url: '/page' }
});
res.end(rc.html);
```

#### build

- **Тип**: `() => Promise<boolean>`

Функция сборки для производственной среды. Используется для упаковки и оптимизации ресурсов. Возвращает true при успешной сборке и false при неудаче.

#### destroy

- **Тип**: `() => Promise<boolean>`

Функция очистки ресурсов. Используется для закрытия серверов, разрыва соединений и т.д. Возвращает true при успешной очистке и false при неудаче.