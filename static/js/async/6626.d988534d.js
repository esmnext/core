"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([["6626"],{62905:function(e,n,s){s.r(n),s.d(n,{default:()=>h});var r=s(31549),d=s(6603);function i(e){let n=Object.assign({h1:"h1",a:"a",p:"p",h3:"h3",h4:"h4",ul:"ul",li:"li",strong:"strong",h2:"h2",code:"code",pre:"pre",ol:"ol"},(0,d.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.h1,{id:"模組連結",children:["模組連結",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#模組連結",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"Gez 框架提供了一套完整的模組連結機制，用於管理服務間的程式碼共享和依賴關係。該機制基於 ESM（ECMAScript Module）規範實現，支援原始碼層級的模組匯出和匯入，以及完整的依賴管理功能。"}),"\n",(0,r.jsxs)(n.h3,{id:"核心概念",children:["核心概念",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#核心概念",children:"#"})]}),"\n",(0,r.jsxs)(n.h4,{id:"模組匯出",children:["模組匯出",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#模組匯出",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"模組匯出是將服務中的特定程式碼單元（如元件、工具函數等）以 ESM 格式對外暴露的過程。支援兩種匯出類型："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"原始碼匯出"}),"：直接匯出專案中的原始碼檔案"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"依賴匯出"}),"：匯出專案使用的第三方依賴套件"]}),"\n"]}),"\n",(0,r.jsxs)(n.h4,{id:"模組連結-1",children:["模組連結",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#模組連結-1",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"模組匯入是在服務中引用其他服務匯出的程式碼單元的過程。支援多種安裝方式："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"原始碼安裝"}),"：適用於開發環境，支援即時修改和熱更新"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"軟體包安裝"}),"：適用於生產環境，直接使用建置產物"]}),"\n"]}),"\n",(0,r.jsxs)(n.h2,{id:"模組匯出-1",children:["模組匯出",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#模組匯出-1",children:"#"})]}),"\n",(0,r.jsxs)(n.h3,{id:"設定說明",children:["設定說明",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#設定說明",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["在 ",(0,r.jsx)(n.code,{children:"entry.node.ts"})," 中設定需要匯出的模組："]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",meta:'title="src/entry.node.ts"',children:"import type { GezOptions } from '@gez/core';\n\nexport default {\n    modules: {\n        exports: [\n            // 匯出原始碼檔案\n            'root:src/components/button.vue',  // Vue 元件\n            'root:src/utils/format.ts',        // 工具函數\n            // 匯出第三方依賴\n            'npm:vue',                         // Vue 框架\n            'npm:vue-router'                   // Vue Router\n        ]\n    }\n} satisfies GezOptions;\n"})}),"\n",(0,r.jsx)(n.p,{children:"匯出設定支援兩種類型："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"root:*"}),"：匯出原始碼檔案，路徑相對於專案根目錄"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"npm:*"}),"：匯出第三方依賴，直接指定套件名稱"]}),"\n"]}),"\n",(0,r.jsxs)(n.h2,{id:"模組匯入",children:["模組匯入",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#模組匯入",children:"#"})]}),"\n",(0,r.jsxs)(n.h3,{id:"設定說明-1",children:["設定說明",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#設定說明-1",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["在 ",(0,r.jsx)(n.code,{children:"entry.node.ts"})," 中設定需要匯入的模組："]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",meta:'title="src/entry.node.ts"',children:"import type { GezOptions } from '@gez/core';\n\nexport default {\n    modules: {\n        // 連結設定\n        links: {\n            // 原始碼安裝：指向建置產物目錄\n            'ssr-remote': 'root:./node_modules/ssr-remote/dist',\n            // 軟體包安裝：指向套件目錄\n            'other-remote': 'root:./node_modules/other-remote'\n        },\n        // 匯入映射設定\n        imports: {\n            // 使用遠端模組中的依賴\n            'vue': 'ssr-remote/npm/vue',\n            'vue-router': 'ssr-remote/npm/vue-router'\n        }\n    }\n} satisfies GezOptions;\n"})}),"\n",(0,r.jsx)(n.p,{children:"設定項說明："}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"imports"}),"：設定遠端模組的本機路徑"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"原始碼安裝：指向建置產物目錄（dist）"}),"\n",(0,r.jsx)(n.li,{children:"軟體包安裝：直接指向套件目錄"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"externals"}),"：設定外部依賴"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"用於共享遠端模組中的依賴"}),"\n",(0,r.jsx)(n.li,{children:"避免重複打包相同依賴"}),"\n",(0,r.jsx)(n.li,{children:"支援多個模組共享依賴"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"安裝方式",children:["安裝方式",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#安裝方式",children:"#"})]}),"\n",(0,r.jsxs)(n.h4,{id:"原始碼安裝",children:["原始碼安裝",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#原始碼安裝",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"適用於開發環境，支援即時修改和熱更新。"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Workspace 方式"}),"\n推薦在 Monorepo 專案中使用："]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",meta:'title="package.json"',children:'{\n    "devDependencies": {\n        "ssr-remote": "workspace:*"\n    }\n}\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Link 方式"}),"\n用於本機開發除錯："]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",meta:'title="package.json"',children:'{\n    "devDependencies": {\n        "ssr-remote": "link:../ssr-remote"\n    }\n}\n'})}),"\n",(0,r.jsxs)(n.h4,{id:"軟體包安裝",children:["軟體包安裝",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#軟體包安裝",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"適用於生產環境，直接使用建置產物。"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"NPM Registry"}),"\n透過 npm registry 安裝："]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",meta:'title="package.json"',children:'{\n    "dependencies": {\n        "ssr-remote": "^1.0.0"\n    }\n}\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"靜態伺服器"}),"\n透過 HTTP/HTTPS 協定安裝："]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",meta:'title="package.json"',children:'{\n    "dependencies": {\n        "ssr-remote": "https://cdn.example.com/ssr-remote/1.0.0.tgz"\n    }\n}\n'})}),"\n",(0,r.jsxs)(n.h2,{id:"軟體包建置",children:["軟體包建置",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#軟體包建置",children:"#"})]}),"\n",(0,r.jsxs)(n.h3,{id:"設定說明-2",children:["設定說明",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#設定說明-2",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["在 ",(0,r.jsx)(n.code,{children:"entry.node.ts"})," 中設定建置選項："]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",meta:'title="src/entry.node.ts"',children:"import type { GezOptions } from '@gez/core';\n\nexport default {\n    // 模組匯出設定\n    modules: {\n        exports: [\n            'root:src/components/button.vue',\n            'root:src/utils/format.ts',\n            'npm:vue'\n        ]\n    },\n    // 建置設定\n    pack: {\n        // 啟用建置\n        enable: true,\n\n        // 輸出設定\n        outputs: [\n            'dist/client/versions/latest.tgz',\n            'dist/client/versions/1.0.0.tgz'\n        ],\n\n        // 自訂 package.json\n        packageJson: async (gez, pkg) => {\n            pkg.version = '1.0.0';\n            return pkg;\n        },\n\n        // 建置前處理\n        onBefore: async (gez, pkg) => {\n            // 產生類型宣告\n            // 執行測試案例\n            // 更新文件等\n        },\n\n        // 建置後處理\n        onAfter: async (gez, pkg, file) => {\n            // 上傳到 CDN\n            // 發布到 npm 倉庫\n            // 部署到測試環境等\n        }\n    }\n} satisfies GezOptions;\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"建置產物",children:["建置產物",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#建置產物",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"your-app-name.tgz\n├── package.json        # 套件資訊\n├── index.js            # 生產環境入口\n├── server/             # 伺服器端資源\n│   └── manifest.json   # 伺服器端資源映射\n├── node/               # Node.js 執行環境\n└── client/             # 客戶端資源\n    └── manifest.json   # 客戶端資源映射\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"發布流程",children:["發布流程",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#發布流程",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# 1. 建置生產版本\ngez build\n\n# 2. 發布到 npm\nnpm publish dist/versions/your-app-name.tgz\n"})})]})}function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,d.ah)(),e.components);return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}let h=t;t.__RSPRESS_PAGE_META={},t.__RSPRESS_PAGE_META["zh-TW%2Fguide%2Fessentials%2Fmodule-link.md"]={toc:[{text:"核心概念",id:"核心概念",depth:3},{text:"模組匯出",id:"模組匯出",depth:4},{text:"模組連結",id:"模組連結-1",depth:4},{text:"模組匯出",id:"模組匯出-1",depth:2},{text:"設定說明",id:"設定說明",depth:3},{text:"模組匯入",id:"模組匯入",depth:2},{text:"設定說明",id:"設定說明-1",depth:3},{text:"安裝方式",id:"安裝方式",depth:3},{text:"原始碼安裝",id:"原始碼安裝",depth:4},{text:"軟體包安裝",id:"軟體包安裝",depth:4},{text:"軟體包建置",id:"軟體包建置",depth:2},{text:"設定說明",id:"設定說明-2",depth:3},{text:"建置產物",id:"建置產物",depth:3},{text:"發布流程",id:"發布流程",depth:3}],title:"模組連結",headingTitle:"模組連結",frontmatter:{titleSuffix:"Gez 框架服務間程式碼共享機制",description:"詳細介紹 Gez 框架的模組連結機制，包括服務間程式碼共享、依賴管理和 ESM 規範實現，幫助開發者建構高效的微前端應用。",head:[["meta",{property:"keywords",content:"Gez, 模組連結, Module Link, ESM, 程式碼共享, 依賴管理, 微前端"}]]}}}}]);